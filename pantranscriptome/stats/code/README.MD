# In this directory you can find the scripts that computes several statistics about the orthofinder result
- computeOrthogroupStats.py: this script needs the Orthogroups.tsv file generated by orthofinder and the number of transcriptomes and gives as output a three column tab separated table called panTranscriptomeClassificationTable.tsv (real table does not have header).

|Classification| Orthogroup | Protein ID|
| ------ | ------ |----------|
|Soft-core |      OG0000000     |  k25_BAZ9504_TRINITY_DN1727_c0_g1_i137.p3|
|Soft-core |      OG0000000     |  k25_BAZ9504_TRINITY_DN1727_c0_g1_i170.p3|
|Soft-core |      OG0000000     |  k25_BAZ9504_TRINITY_DN1727_c0_g1_i76.p3|
|Soft-core |      OG0000000     | k31_BAZ9504_TRINITY_DN1629_c0_g1_i129.p1|
|Soft-core |      OG0000000     |  k31_BAZ9504_TRINITY_DN1629_c0_g1_i152.p1|

you can run the script as follows: 
```sh
python computeOrthogroupStats.py --orthogroupsFile Orthogroups.tsv --numberSpecies 20
```
```sh
Number of groups present in all (20) species:	30
Number of proteins present in core groups:	2474
Number of groups present in 90% of the species (18.0):	1385
Number of proteins present in soft-core groups:	85950
Number of accesory groups:	293335
Number of proteins present in accessory groups:	3338131
Number of exclusive groups:	95054
Number of proteins present in exclusive groups:	346929
```
- extractPanTranscriptomeGroups.py: this script needs as input the Orthogroups.GeneCount.tsv file generate by orthofinder, first we remove the column called total:
```sh
awk 'BEGIN{OFS="\t"} {NF--} 1' Orthogroups.GeneCount.tsv > Orthogroups.GeneCount.nototal.tsv
```
and we use this file to run extractPanTranscriptomeGroups.py 
```sh
python extractPanTranscriptomeGroups.py -i Orthogroups.GeneCount.nototal.tsv
cat header Pan-Transcriptome_Size.Orthogroups.GeneCount.nototal.tsv > table_for_plots.tsv
```
this will generate this table table_for_plots.tsv:

|pan_transcriptome_size | genes_pan |      hard_core_transcriptome_size |   genes_hard_core| soft_core_transcriptome_size |   genes_soft_core | accessory_transcriptome_size|    genes_accessory | exclusive_transcriptome_size |   genes_exclusive | number_genotypes|        n_sample|
|-----|-------|------|-----|------|-----|-------|-------|-------|-------|-------|-------|
|42255|   112813|  42255  | 112813|  0    |   0 |      0      | 0  |     347519 | 0 |      1    |   0|
|64156|   143394|  64156   |143394|  0   |    0  |     0       |0   |    325618 | 0 |      1     |  1|
|132957|  377970|  132957 | 377970|  0  |     0   |    0      | 0    |   256817 | 0 |      1     |  2|
|38885|   92212 |  38885 |  92212 |  0 |      0    |   0     |  0  |     350889  |0 |      1      | 3|
|85690|   159888|  85690|   159888 | 0 |      0     |  0    |   0   |    304084 | 0 |      1      | 4 |
- plotPanTranscriptomeGroups.py: this script makes a plot of the orthogroups vs Number of genotypes.
```sh
python plotPanTranscriptomeGroups.py
```
![Orthogroups vs genotypes](https://github.com/jomare1188/SORGHUM_PAN/blob/master/pantranscriptome/stats/results/raw_saturation.png?raw=true)

