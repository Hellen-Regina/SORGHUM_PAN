# In this directory you can find the scripts that computes several statistics about the orthofinder result
- computeOrthogroupStats.py: this script needs the Orthogroups.tsv file generated by orthofinder and the number of transcriptomes and gives as output a three column tab separated table called panTranscriptomeClassificationTable.tsv (real table does not have header).

|Classification| Orthogroup | Protein ID|
| ------ | ------ |----------|
|Soft-core |      OG0000000     |  k25_BAZ9504_TRINITY_DN1727_c0_g1_i137.p3|
|Soft-core |      OG0000000     |  k25_BAZ9504_TRINITY_DN1727_c0_g1_i170.p3|
|Soft-core |      OG0000000     |  k25_BAZ9504_TRINITY_DN1727_c0_g1_i76.p3|
|Soft-core |      OG0000000     | k31_BAZ9504_TRINITY_DN1629_c0_g1_i129.p1|
|Soft-core |      OG0000000     |  k31_BAZ9504_TRINITY_DN1629_c0_g1_i152.p1|

you can run the script as follows: 
```sh
python computeOrthogroupStats.py --orthogroupsFile ../data/Orthogroups_I3.0.tsv --numberSpecies 18 --suffixOut I3.0
```
it will create panTranscriptomeClassificationTable_I3.0.tsv, panTranscriptomeDistributionSizeOrthogroupsTable_I3.0.png, panTranscriptomeDistributionSizeOrthogroupsTable_I3.0.svg, panTranscriptomeDistributionSizeOrthogroupsTable_I3.0.tsv, panTranscriptomeStatisticsOrthogroups_I3.0.tsv.

```sh
Number of groups present in all (18) species:   0
Number of proteins present in core groups:      0
Number of groups present in 90% of the species (16.2):  0
Number of proteins present in soft-core groups: 0
Number of accesory groups:      147285
Number of proteins present in accessory groups: 1762529
Number of exclusive groups:     26460
Number of proteins present in exclusive groups: 77344
```
- extractPanTranscriptomeGroups.py: this script needs as input the Orthogroups.GeneCount.tsv file generate by orthofinder
 
```sh
python extractPanTranscriptomeGroups.py -i Orthogroups.GeneCount_I3.0.tsv
```
this will generate this table table_for_plots.tsv:

|pan_transcriptome_size | genes_pan |      hard_core_transcriptome_size |   genes_hard_core| soft_core_transcriptome_size |   genes_soft_core | accessory_transcriptome_size|    genes_accessory | exclusive_transcriptome_size |   genes_exclusive | number_genotypes|        n_sample|
|-----|-------|------|-----|------|-----|-------|-------|-------|-------|-------|-------|
|42255|   112813|  42255  | 112813|  0    |   0 |      0      | 0  |     347519 | 0 |      1    |   0|
|64156|   143394|  64156   |143394|  0   |    0  |     0       |0   |    325618 | 0 |      1     |  1|
|132957|  377970|  132957 | 377970|  0  |     0   |    0      | 0    |   256817 | 0 |      1     |  2|
|38885|   92212 |  38885 |  92212 |  0 |      0    |   0     |  0  |     350889  |0 |      1      | 3|
|85690|   159888|  85690|   159888 | 0 |      0     |  0    |   0   |    304084 | 0 |      1      | 4 |

- plotPanTranscriptomeGroups.py: this script makes a plot of the orthogroups vs Number of genotypes.
```sh
python plotPanTranscriptomeGroups.py
```

Or you can group table_for_plots.tsv in table_for_plots_grouped.csv and use plotPanTranscriptomeGroups.r

```sh
Rscript plotPanTranscriptomeGroups.r
```

![Orthogroups vs genotypes](https://github.com/jomare1188/SORGHUM_PAN/blob/master/pantranscriptome/stats/results/pan_groups.png?raw=true)

